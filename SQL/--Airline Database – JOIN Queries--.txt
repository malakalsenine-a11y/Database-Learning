--Airline Database – JOIN Queries--

--1. Display each flight leg's ID, schedule, and the name of the airplane assigned to it.--
select * from Flight_Leg;
select * from Leg_Instance;
SELECT fl.leg_no AS LegID, fl.scheduled_dep_time, fl.scheduled_arr_time, a.type_name AS AirplaneName
FROM Flight_Leg fl JOIN Leg_Instance li
ON fl.leg_no = li.leg_no JOIN Airplane a
ON li.airplane_id = a.airplane_id;

--2. Display all flight numbers and the names of the departure and arrival airports.--
SELECT  f.flight_no, a1.name AS DepartureAirport, a2.name AS ArrivalAirport
FROM Flight f JOIN Flight_Leg fl
ON f.flight_no = fl.flight_no JOIN Airport a1
ON fl.dep_airport = a1.airport_code JOIN Airport a2
ON fl.arr_airport = a2.airport_code;

--3. Display all reservation data with the name and phone of the customer who made each booking.--
SELECT * FROM Reservation;
SELECT reservation_id, customer_name, phone, seat_no, leg_no, leg_date
FROM Reservation;


--4. Display IDs and locations of flights departing from 'MCT' or 'DXB'.--
select * from Flight_Leg;
SELECT fl.leg_no AS FlightLegID, a.name AS DepartureAirport
FROM Flight_Leg fl JOIN Airport a ON fl.dep_airport = a.airport_code
WHERE fl.dep_airport IN ('MCT', 'DXB');

--5. Display full data of flights whose names start with 'O'.--
select * from Flight_Leg;
SELECT * FROM Flight
WHERE airline LIKE 'O%';

--6. List customers who have bookings with total payment between 3000 and 5000.--
SELECT 
    r.customer_name,
    f.amount AS Payment
FROM Reservation r
JOIN Leg_Instance li
    ON r.leg_no = li.leg_no AND r.leg_date = li.leg_date
JOIN Flight_Leg fl
    ON li.leg_no = fl.leg_no
JOIN Fare f
    ON fl.flight_no = f.flight_no;



--7. Retrieve all passengers on 'Flight 110' who booked more than 2 seats.--


--8. Find names of passengers whose booking was handled by agent "Youssef Hamed".--
--9. Display each passenger’s name and the flights they booked, ordered by flight date.--
--10. For each flight departing from 'Cairo', display the flight number, departure time, and airline name.--
--11. Display all staff members who are assigned as supervisors for flights.--
--12. Display all bookings and their related passen